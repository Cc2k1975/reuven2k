<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>השף שלי - גרסת עריכה מלאה</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

  <style>
    :root {
      --primary: #e67e22;
      --secondary: #d35400;
      --bg: #fdf5e6;
      --text: #2c3e50;
      --shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
    
    body {
      font-family: 'Rubik', sans-serif;
      background: var(--bg);
      color: var(--text);
      padding-bottom: 100px;
    }

    header {
      background: #fff;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header h1 { font-size: 22px; color: var(--primary); margin: 0; }
    
    /* --- כפתורים --- */
    .btn-icon {
      background: none; border: none; font-size: 18px; cursor: pointer; color: #555;
    }
    
    .nav-tabs {
      display: flex; justify-content: center; gap: 10px; margin: 20px auto; padding: 0 10px; max-width: 600px;
    }
    .nav-btn {
      flex: 1; padding: 12px; border: 1px solid var(--primary); background: transparent;
      color: var(--primary); border-radius: 50px; font-weight: 700; cursor: pointer; transition: 0.3s;
    }
    .nav-btn.active {
      background: var(--primary); color: #fff; box-shadow: 0 5px 15px rgba(230, 126, 34, 0.4);
    }

    /* --- גריד מתכונים --- */
    .container { max-width: 1000px; margin: 0 auto; padding: 10px; }
    .recipe-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
    
    .recipe-card {
      background: #fff; border-radius: 15px; overflow: hidden; box-shadow: var(--shadow);
      cursor: pointer; transition: transform 0.2s; position: relative;
    }
    .recipe-card:active { transform: scale(0.98); }
    
    .card-img-wrapper {
      width: 100%; height: 180px; background: #eee;
      display: flex; align-items: center; justify-content: center; overflow: hidden;
    }
    .card-img { width: 100%; height: 100%; object-fit: cover; }
    .card-title { padding: 12px; text-align: center; font-size: 18px; font-weight: 600; color: #333; }
    
    /* כפתורי מחיקה ועריכה על הכרטיס */
    .card-actions {
      position: absolute; top: 10px; left: 10px; display: flex; gap: 8px; z-index: 2;
    }
    .action-btn {
      background: rgba(255,255,255,0.9); border: none; border-radius: 50%;
      width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .btn-delete { color: #ff4757; }
    .btn-edit { color: #2980b9; }

    /* כפתור פלוס צף */
    .fab {
      position: fixed; bottom: 30px; left: 30px; width: 65px; height: 65px;
      background: var(--primary); color: white; border-radius: 50%; border: none;
      font-size: 35px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); cursor: pointer; z-index: 100;
    }

    /* --- מודאלים --- */
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center; z-index: 2000;
      opacity: 0; pointer-events: none; transition: opacity 0.3s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: auto; }

    .modal {
      background: #fff; width: 95%; max-width: 600px; height: 90vh;
      border-radius: 20px; display: flex; flex-direction: column;
      overflow: hidden; animation: slideUp 0.3s ease;
    }
    @keyframes slideUp { from {transform: translateY(50px);} to {transform: translateY(0);} }

    .modal-header {
      padding: 15px; background: #f9f9f9; border-bottom: 1px solid #ddd;
      display: flex; justify-content: space-between; align-items: center;
    }
    .modal-header h2 { font-size: 20px; color: var(--primary); margin:0;}
    .close-btn { background: none; border: none; font-size: 28px; cursor: pointer; color: #777; }
    .modal-body { padding: 20px; overflow-y: auto; flex: 1; }

    /* --- טופס --- */
    .section-title {
      font-size: 16px; color: var(--secondary); margin: 20px 0 10px 0;
      border-bottom: 2px solid #eee; padding-bottom: 5px; font-weight: 700;
    }
    .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; background: #fafafa; }
    
    .dynamic-row { display: flex; gap: 8px; margin-bottom: 8px; align-items: center; }
    .dynamic-row select, .dynamic-row input { padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
    .btn-remove { background: #ff7675; color: white; border: none; width: 35px; height: 35px; border-radius: 8px; flex-shrink: 0; }
    .btn-add-line {
      width: 100%; padding: 10px; border: 2px dashed #ccc; color: #777;
      background: none; border-radius: 10px; cursor: pointer; font-weight: 600;
    }
    .btn-save {
      background: var(--primary); color: white; width: 100%; padding: 15px;
      font-size: 18px; border: none; font-weight: bold; cursor: pointer;
    }

    .view-image { width: 100%; height: 250px; object-fit: cover; border-radius: 10px; margin-bottom: 15px; }
    .view-times { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; }
    .time-tag {
      background: var(--primary); color: white; padding: 5px 12px;
      border-radius: 20px; font-size: 14px; display: flex; align-items: center; gap: 5px;
    }
    .ing-list-view { list-style: none; border: 1px solid #eee; border-radius: 10px; padding: 10px; }
    .ing-list-view li { display: flex; justify-content: space-between; padding: 8px; border-bottom: 1px dashed #eee; }
    .ing-amount { font-weight: bold; color: var(--primary); }
    .file-drop { border: 2px solid #ddd; padding: 20px; text-align: center; border-radius: 10px; color: #999; }
    #previewImgInput { width: 100%; height: 150px; object-fit: cover; margin-top: 10px; display: none; border-radius: 8px; }

    #loadingIndicator { text-align: center; padding: 20px; color: #999; display: none; }
    
    /* עיצוב לדאטה ליסט שיעבוד טוב יותר */
    input[list] {
        background-color: #fcfcfc;
    }
  </style>
</head>
<body>

  <datalist id="ingredientsDataList"></datalist>
  <datalist id="spicesDataList"></datalist>

  <header>
    <h1>השף שלי</h1>
    <div></div>
  </header>

  <div class="nav-tabs">
    <button class="nav-btn active" onclick="setCategory('cooking')">בישולים</button>
    <button class="nav-btn" onclick="setCategory('desserts')">קינוחים</button>
  </div>

  <div class="container">
    <div id="loadingIndicator"><i class="fas fa-spinner fa-spin"></i> טוען מתכונים...</div>
    <div id="grid" class="recipe-grid"></div>
  </div>

  <button class="fab" onclick="openAddModal()">+</button>

  <div class="modal-overlay" id="addModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="modalTitle">הוספת מתכון</h2>
        <button class="close-btn" onclick="closeModal('addModal')">&times;</button>
      </div>
      <div class="modal-body">
        <input type="text" id="recipeTitle" class="form-control" placeholder="שם המנה...">
        
        <div style="margin-top:15px;" class="file-drop" onclick="document.getElementById('fileInput').click()">
          <i class="fas fa-camera"></i> בחר תמונה
          <input type="file" id="fileInput" hidden accept="image/*" onchange="previewImage(this)">
          <img id="previewImgInput">
        </div>

        <div class="section-title">זמנים</div>
        <div id="timesContainer"></div>
        <button type="button" class="btn-add-line" onclick="addTimeRow()">+ הוסף זמן</button>

        <div class="section-title">מצרכים</div>
        <div id="ingredientsContainer"></div>
        <button type="button" class="btn-add-line" onclick="addIngredientRow()">+ הוסף מצרך</button>

        <div class="section-title">תבלינים</div>
        <div id="spicesContainer"></div>
        <button type="button" class="btn-add-line" onclick="addSpiceRow()">+ הוסף תבלין</button>

      </div>
      <button class="btn-save" onclick="saveRecipe()">שמור מתכון</button>
    </div>
  </div>

  <div class="modal-overlay" id="viewModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="viewTitle"></h2>
        <button class="close-btn" onclick="closeModal('viewModal')">&times;</button>
      </div>
      <div class="modal-body">
        <img id="viewImg" class="view-image" src="">
        <div id="viewTimes" class="view-times"></div>
        <h3 style="font-size:18px; margin-bottom:10px;">מצרכים:</h3>
        <ul id="viewIngredients" class="ing-list-view"></ul>
        <h3 style="font-size:18px; margin-top:20px; margin-bottom:10px;">תבלינים:</h3>
        <ul id="viewSpices" class="ing-list-view"></ul>
      </div>
    </div>
  </div>

  <script>
    // --- הגדרות Firebase שלך ---
    const firebaseConfig = {
      apiKey: "AIzaSyBGrNVQ2DFHHD2-lv2tuSoO02Y3ImKggoo",
      authDomain: "cooking-e45ca.firebaseapp.com",
      projectId: "cooking-e45ca",
      storageBucket: "cooking-e45ca.firebasestorage.app",
      messagingSenderId: "710717068396",
      appId: "1:710717068396:web:829ddd9c9be71a090f3449",
      measurementId: "G-4CTG6186BT",
      databaseURL: "https://cooking-e45ca-default-rtdb.europe-west1.firebasedatabase.app"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const recipesRef = db.ref('recipes');

    // --- הנתונים הגדולים ששלחת (מאוחדים כדי שיופיעו תמיד) ---
    const fullSpicesList = [
      "מלח", "פלפל שחור", "פלפל לבן", "פפריקה מתוקה", "פפריקה חריפה", "כמון", "כורכום", 
      "כוסברה טחונה", "קינמון", "אגוז מוסקט", "זנגביל (ג׳ינג׳ר) טחון", "הל טחון", "ציפורן טחונה",
      "שום גבישי", "בצל גבישי", "אורגנו", "בזיליקום", "טימין", "רוזמרין", "עלי דפנה",
      "פלפל אנגלי", "צ׳ילי גרוס", "סומאק", "זעתר", "ראס אל חנות", "תבלין שווארמה",
      "תבלין גריל / על האש", "תבלין עוף", "תבלין קבב", "תבלין סטייק", "קארי", "פטרוזיליה מיובשת",
      "שמיר מיובש", "חרדל טחון", "פלפל ארבע העונות"
    ];

    const fullIngredientsList = [
      // דגנים וקמחים
      "אטריות ביצים", "אטריות אורז", "אורז בסמטי", "אורז לבן", "אורז מלא", "בורגול",
      "קמח לבן", "קמח מלא", "קמח תופח", "קמח תירס", "קוסקוס", "קוואקר", "לחם פרוס",
      "פסטה מחיטה מלאה", "פסטה רגילה", "פתיתים", "פירורי לחם", "שיבולת שועל", "סולת", "טורטיות",
      // חלבונים
      "אסאדו", "בשר בקר לבישול", "בשר טחון", "בשר מספר 5", "בשר מספר 8", "הודו", "המבורגר קפוא",
      "חזה עוף", "טונה משומרת", "כבד עוף", "כנפיים", "קבבים מוכנים", "נקניק לבישול", "נקניקיות",
      "סלמון", "סרדינים", "עוף שלם", "כרעיים עוף", "דג אמנון", "דגים קפואים",
      // קטניות וביצים
      "אפונה יבשה", "ביצים", "חומוס משומר", "חומוס יבש", "עדשים ירוקות", "עדשים כתומות",
      "פול", "סויה יבשה", "שעועית אדומה", "שעועית לבנה",
      // ירקות טריים
      "בטטה", "בצל", "בצל ירוק", "גזר", "חסה", "חציל", "שום", "סלרי", "עגבניות", "קישוא",
      "כרוב לבן", "כרוב סגול", "כוסברה", "מלפפונים", "פטרוזיליה", "פלפל אדום", "פלפל ירוק", "פלפל צהוב", "תפוחי אדמה",
      // ירקות קפואים
      "אפונה קפואה", "ברוקולי קפוא", "כרובית קפואה", "שעועית ירוקה קפואה", "תירס קפוא",
      // מוצרי חלב
      "גבינה לבנה", "גבינה מגורדת", "גבינה צהובה", "גבינת שמנת", "חמאה", "חלב", "חלב עמיד",
      "יוגורט", "יוגורט יווני", "שמנת לבישול",
      // שמנים
      "חומץ", "חומץ בלסמי", "חומץ תפוחים", "טחינה גולמית", "מרגרינה", "ספריי שמן",
      "שמן זית", "שמן חמניות", "שמן קנולה", "שמן שומשום",
      // שימורים
      "חומוס מוכן", "זיתים ירוקים", "זיתים שחורים", "מלפפונים חמוצים", "פטריות משומרות",
      "רוטב עגבניות", "רסק עגבניות", "טחינה מוכנה", "תירס משומר", "עגבניות מרוסקות",
      // רטבים ומתוקים
      "דבש", "חרדל", "מיונז", "סוכר", "סילאן", "קטשופ", "רוטב ברביקיו", "רוטב סויה",
      "רוטב טריאקי", "רוטב צ'ילי מתוק",
      // אפייה
      "אבקת אפייה", "וניל", "קקאו", "קוקוס טחון", "קורנפלור", "סודה לשתייה", "סוכר חום",
      "שמרים יבשים", "שוקולד חלב", "שוקולד מריר",
      // אגוזים
      "בוטנים", "חמוציות", "צימוקים", "שקדים"
    ];

    let recipes = [];
    let currentCategory = 'cooking';
    let tempImage = null;
    let editingRecipeId = null; // משתנה לזיהוי אם אנחנו במצב עריכה

    // --- אתחול והאזנה ---
    document.addEventListener('DOMContentLoaded', () => {
        populateDataLists(); // מילוי הרשימות מיד בטעינה
    });

    document.getElementById('loadingIndicator').style.display = 'block';
    recipesRef.on('value', (snapshot) => {
        document.getElementById('loadingIndicator').style.display = 'none';
        const data = snapshot.val();
        recipes = [];
        if (data) {
            Object.keys(data).forEach(key => {
                recipes.push({ id: key, ...data[key] });
            });
        }
        recipes.reverse(); // החדש ביותר למעלה
        renderGrid();
    });

    // --- פונקציית מילוי הרשימות (קומבו) ---
    function populateDataLists() {
        const ingList = document.getElementById('ingredientsDataList');
        const spiceList = document.getElementById('spicesDataList');
        
        ingList.innerHTML = '';
        spiceList.innerHTML = '';

        fullIngredientsList.sort().forEach(item => {
            const opt = document.createElement('option');
            opt.value = item;
            ingList.appendChild(opt);
        });

        fullSpicesList.sort().forEach(item => {
            const opt = document.createElement('option');
            opt.value = item;
            spiceList.appendChild(opt);
        });
    }

    // --- ניווט וקטגוריות ---
    function setCategory(cat) {
      currentCategory = cat;
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      renderGrid();
    }

    function renderGrid() {
      const grid = document.getElementById('grid');
      const filtered = recipes.filter(r => r.category === currentCategory);
      
      if(filtered.length === 0) {
        grid.innerHTML = '<div style="text-align:center; grid-column:1/-1; padding:40px; color:#999;">אין מתכונים כאן עדיין.</div>';
        return;
      }

      grid.innerHTML = filtered.map(r => `
        <div class="recipe-card" onclick="openViewModal('${r.id}')">
          <div class="card-actions">
             <button class="action-btn btn-edit" onclick="event.stopPropagation(); editRecipe('${r.id}')">
                <i class="fas fa-pen"></i>
             </button>
             <button class="action-btn btn-delete" onclick="event.stopPropagation(); deleteRecipe('${r.id}')">
                <i class="fas fa-trash"></i>
             </button>
          </div>
          <div class="card-img-wrapper">
            <img src="${r.image || 'https://via.placeholder.com/300?text=No+Image'}" class="card-img">
          </div>
          <div class="card-title">${r.title}</div>
        </div>
      `).join('');
    }

    // --- הוספה / עריכה ושמירה ---

    function openAddModal() {
      editingRecipeId = null; // מצב הוספה חדשה
      document.getElementById('modalTitle').textContent = "הוספת מתכון";
      resetForm();
      document.getElementById('addModal').classList.add('open');
    }

    function editRecipe(id) {
        const r = recipes.find(i => i.id === id);
        if (!r) return;

        editingRecipeId = id; // מצב עריכה
        document.getElementById('modalTitle').textContent = "עריכת מתכון";
        
        // מילוי הטופס בנתונים הקיימים
        document.getElementById('recipeTitle').value = r.title;
        tempImage = r.image;
        if(tempImage) {
            document.getElementById('previewImgInput').src = tempImage;
            document.getElementById('previewImgInput').style.display = 'block';
        } else {
            document.getElementById('previewImgInput').style.display = 'none';
        }

        // ניקוי ומילוי שורות
        document.getElementById('timesContainer').innerHTML = '';
        document.getElementById('ingredientsContainer').innerHTML = '';
        document.getElementById('spicesContainer').innerHTML = '';

        if(r.times) r.times.forEach(t => addTimeRow(t.type, t.duration));
        else addTimeRow();

        if(r.ingredients) r.ingredients.forEach(i => addIngredientRow(i.name, i.amount, i.unit));
        else addIngredientRow();

        if(r.spices) r.spices.forEach(s => addSpiceRow(s.name, s.amount, s.unit));
        else addSpiceRow();

        document.getElementById('addModal').classList.add('open');
    }

    function saveRecipe() {
      const title = document.getElementById('recipeTitle').value;
      if(!title) return alert("חייב שם למתכון");

      const times = [];
      document.querySelectorAll('#timesContainer .dynamic-row').forEach(row => {
        const selects = row.querySelectorAll('select');
        times.push({ type: selects[0].value, duration: selects[1].value });
      });

      const collectItems = (containerId) => {
        const items = [];
        document.querySelectorAll(`#${containerId} .dynamic-row`).forEach(row => {
          const inputs = row.querySelectorAll('input');
          const select = row.querySelector('select');
          if(inputs[0].value) {
            items.push({ name: inputs[0].value, amount: inputs[1].value, unit: select.value });
          }
        });
        return items;
      };

      const recipeData = {
        category: currentCategory,
        title,
        image: tempImage,
        times,
        ingredients: collectItems('ingredientsContainer'),
        spices: collectItems('spicesContainer'),
        updatedAt: firebase.database.ServerValue.TIMESTAMP
      };

      if (editingRecipeId) {
          // עדכון מתכון קיים
          db.ref('recipes/' + editingRecipeId).update(recipeData)
            .then(() => closeModal('addModal'))
            .catch(err => alert("שגיאה בעדכון: " + err.message));
      } else {
          // יצירת מתכון חדש
          recipeData.createdAt = firebase.database.ServerValue.TIMESTAMP;
          recipesRef.push(recipeData)
            .then(() => closeModal('addModal'))
            .catch(err => alert("שגיאה בשמירה: " + err.message));
      }
    }

    function deleteRecipe(id) {
      if(confirm("למחוק את המתכון לצמיתות?")) {
        db.ref('recipes/' + id).remove();
      }
    }

    // --- עזרים לטופס ---

    function resetForm() {
        document.getElementById('recipeTitle').value = '';
        document.getElementById('fileInput').value = '';
        document.getElementById('previewImgInput').style.display = 'none';
        tempImage = null;
        document.getElementById('timesContainer').innerHTML = '';
        document.getElementById('ingredientsContainer').innerHTML = '';
        document.getElementById('spicesContainer').innerHTML = '';
        addTimeRow(); addIngredientRow(); addSpiceRow();
    }

    const unitsOptions = `
      <option value="גרם">גרם</option><option value='ק"ג'>ק"ג</option>
      <option value="יחידות">יחידות</option><option value="כפית">כפית</option>
      <option value="כף">כף</option><option value='כוס חד"פ'>כוס חד"פ</option>
      <option value="ספל">ספל</option><option value="מ"ל">מ"ל</option>
      <option value="ליטר">ליטר</option><option value="קופסה">קופסה</option>
      <option value="חבילה">חבילה</option>
    `;

    const timeTypes = `
      <option value="בישול">בישול</option><option value="השרייה">השרייה</option>
      <option value="חימום תנור">חימום תנור</option><option value="אפייה">אפייה</option>
      <option value="הטפחה">הטפחה</option><option value="טיגון">טיגון</option>
      <option value="קירור">קירור</option>
    `;

    function generateTimeList() {
      let html = '';
      for(let i=1; i<=10; i++) html += `<option value="${i} דקות">${i} דקות</option>`;
      for(let i=15; i<=55; i+=5) html += `<option value="${i} דקות">${i} דקות</option>`;
      html += `<option value="שעה">שעה</option><option value="שעה וחצי">שעה וחצי</option>
               <option value="שעתיים">שעתיים</option><option value="לילה">לילה</option>`;
      return html;
    }
    const timeValues = generateTimeList();

    function addTimeRow(typeVal = 'בישול', durationVal = '1 דקות') {
      const div = document.createElement('div'); div.className = 'dynamic-row';
      div.innerHTML = `<select style="flex:1;">${timeTypes}</select><select style="flex:1;">${timeValues}</select><button class="btn-remove" onclick="this.parentElement.remove()">X</button>`;
      
      if(typeVal) div.querySelectorAll('select')[0].value = typeVal;
      if(durationVal) div.querySelectorAll('select')[1].value = durationVal;
      
      document.getElementById('timesContainer').appendChild(div);
    }

    function addIngredientRow(nameVal = '', amountVal = '', unitVal = 'גרם') {
      const div = document.createElement('div'); div.className = 'dynamic-row';
      div.innerHTML = `<input type="text" list="ingredientsDataList" placeholder="מצרך" style="flex:2;" value="${nameVal}"><input type="number" placeholder="כמות" style="flex:1;" value="${amountVal}"><select style="flex:1;">${unitsOptions}</select><button class="btn-remove" onclick="this.parentElement.remove()">X</button>`;
      if(unitVal) div.querySelector('select').value = unitVal;
      document.getElementById('ingredientsContainer').appendChild(div);
    }

    function addSpiceRow(nameVal = '', amountVal = '', unitVal = 'כפית') {
      const div = document.createElement('div'); div.className = 'dynamic-row';
      div.innerHTML = `<input type="text" list="spicesDataList" placeholder="תבלין" style="flex:2;" value="${nameVal}"><input type="number" placeholder="כמות" style="flex:1;" value="${amountVal}"><select style="flex:1;">${unitsOptions}</select><button class="btn-remove" onclick="this.parentElement.remove()">X</button>`;
      if(unitVal) div.querySelector('select').value = unitVal;
      document.getElementById('spicesContainer').appendChild(div);
    }

    // --- צפייה ועזרים ---
    function openViewModal(id) {
      const r = recipes.find(i => i.id === id);
      if(!r) return;
      document.getElementById('viewTitle').textContent = r.title;
      document.getElementById('viewImg').src = r.image || 'https://via.placeholder.com/300?text=No+Image';
      
      document.getElementById('viewTimes').innerHTML = (r.times || []).map(t => `<div class="time-tag"><i class="far fa-clock"></i> ${t.type}: ${t.duration}</div>`).join('');
      
      const createList = (items) => (!items || items.length===0) ? '<li>אין</li>' : items.map(i => `<li><span>${i.name}</span><span class="ing-amount">${i.amount} ${i.unit}</span></li>`).join('');
      
      document.getElementById('viewIngredients').innerHTML = createList(r.ingredients);
      document.getElementById('viewSpices').innerHTML = createList(r.spices);
      document.getElementById('viewModal').classList.add('open');
    }
    
    function closeModal(id) { document.getElementById(id).classList.remove('open'); }
    function previewImage(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          tempImage = e.target.result;
          document.getElementById('previewImgInput').src = tempImage;
          document.getElementById('previewImgInput').style.display = 'block';
        }
        reader.readAsDataURL(input.files[0]);
      }
    }
  </script>
</body>
</html>
