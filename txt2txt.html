<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משווה טקסט מדויק</title>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; margin: 0; padding: 15px; background: #f4f4f9; direction: rtl; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h2 { font-size: 1.2rem; text-align: center; color: #333; }
        textarea { width: 100%; height: 100px; margin: 8px 0; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 14px; background: #007bff; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }
        
        #resultContainer { margin-top: 20px; }
        .visual-diff { background: #fff; border: 1px solid #ddd; padding: 10px; border-radius: 8px; white-space: pre-wrap; word-break: break-all; line-height: 1.8; font-family: monospace; }
        
        /* עיצוב ההבדלים */
        .highlight { background-color: #ffff00; border-bottom: 2px solid #ffcc00; font-weight: bold; padding: 0 2px; }
        .explanation-box { margin-top: 15px; padding: 10px; background: #e9ecef; border-right: 4px solid #007bff; border-radius: 4px; font-size: 14px; }
        .match-msg { background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; text-align: center; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <h2>השוואה מדויקת (מילה במילה)</h2>
    
    <label>טקסט 1:</label>
    <textarea id="text1" placeholder="הדבק טקסט מקור..."></textarea>

    <label>טקסט 2:</label>
    <textarea id="text2" placeholder="הדבק טקסט לבדיקה..."></textarea>

    <button onclick="compareSmart()">השווה עכשיו</button>

    <div id="resultContainer"></div>
</div>

<script>
    function compareSmart() {
        const s1 = document.getElementById('text1').value;
        const s2 = document.getElementById('text2').value;
        const container = document.getElementById('resultContainer');
        
        if (s1 === s2 && s1 !== "") {
            container.innerHTML = '<div class="match-msg">✅ הטקסטים זהים לחלוטין!</div>';
            return;
        }

        // פיצול למילים (כולל רווחים וסימני פיסוק כשומרים עליהם)
        const words1 = s1.split(/(\s+|[.,!?;:])/);
        const words2 = s2.split(/(\s+|[.,!?;:])/);
        
        let htmlOutput = '<div class="visual-diff">';
        let explanations = [];
        
        const maxLength = Math.max(words1.length, words2.length);

        for (let i = 0; i < maxLength; i++) {
            const w1 = words1[i] || "";
            const w2 = words2[i] || "";

            if (w1 !== w2) {
                // מצאנו הבדל - נצבע את המילה בטקסט השני
                htmlOutput += `<span class="highlight">${escapeHtml(w2 || "[חסר]")}</span>`;
                
                // יצירת הסבר מדויק
                let reason = "";
                if (!w1 && w2) reason = `נוספה המילה "${w2}"`;
                else if (w1 && !w2) reason = `נמחקה המילה "${w1}"`;
                else if (w1.toLowerCase() === w2.toLowerCase()) reason = `שינוי באותיות גדולות/קטנות ("${w1}" לעומת "${w2}")`;
                else if (w1.trim() === "" && w2.trim() !== "") reason = `נוסף רווח או אנטר`;
                else reason = `הוחלף "${w1}" ב-"${w2}"`;
                
                explanations.push(`שגיאה ליד "${words2[i-2] || ""} ${words2[i-1] || ""}": ${reason}`);
            } else {
                htmlOutput += escapeHtml(w2);
            }
        }
        
        htmlOutput += '</div>';

        // הוספת הסברים למטה
        if (explanations.length > 0) {
            htmlOutput += '<div class="explanation-box"><strong>מה השתנה?</strong><br><ul>' + 
                explanations.map(ex => `<li>${ex}</li>`).join('') + 
                '</ul></div>';
        }

        container.innerHTML = htmlOutput;
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
</script>

</body>
</html>
