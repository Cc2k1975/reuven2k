<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Global Timer</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: black;
        color: white;
        font-family: Arial, sans-serif;
        overflow: hidden;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    #eventName {
        font-size: 48px;
        margin-bottom: 20px;
    }

    .timer-row {
        display: flex;
        gap: 20px;
        justify-content: center;
        align-items: center;
    }

    .time-block {
        text-align: center;
    }

    .time-value {
        font-size: 64px;
        color: #00ff80;
        text-shadow: 0 0 20px #00ff80;
        direction: ltr;
    }

    .label {
        margin-top: 10px;
        font-size: 22px;
        letter-spacing: 8px;
    }

    #version {
        position: absolute;
        bottom: 10px;
        left: 10px;
        font-size: 12px;
        opacity: 0.6;
    }
</style>

</head>
<body>

<div id="eventName">בזיקה</div>

<div class="timer-row">
    <div class="time-block">
        <div id="days" class="time-value">000</div>
        <div class="label">D</div>
    </div>

    <div class="time-block">
        <div id="hours" class="time-value">00</div>
        <div class="label">H</div>
    </div>

    <div class="time-block">
        <div id="minutes" class="time-value">00</div>
        <div class="label">M</div>
    </div>

    <div class="time-block">
        <div id="seconds" class="time-value">00</div>
        <div class="label">S</div>
    </div>
</div>

<div id="version">v1.1</div>

<script type="module">
// ----------------------
// FIREBASE – NO CHANGES
// ----------------------
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAeUBBZDPZnDIcAvluwzubNtbs3xjmTqls",
  authDomain: "global-timer-8ebbd.firebaseapp.com",
  projectId: "global-timer-8ebbd",
  storageBucket: "global-timer-8ebbd.firebasestorage.app",
  messagingSenderId: "603403671136",
  appId: "1:603403671136:web:0269c03a847a1fb3d81505",
  measurementId: "G-WW8L0XHPGB"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ----------------------
// TIMER DISPLAY LOGIC
// ----------------------
let eventTimestamp = 0;

onSnapshot(doc(db, "globalTimer", "event"), (snap) => {
    const data = snap.data();
    if (!data) return;
    document.getElementById("eventName").innerText = data.name || "—";
    eventTimestamp = data.timestamp;
});

setInterval(() => {
    if (!eventTimestamp) return;

    const now = Date.now();
    let diff = eventTimestamp - now;
    if (diff < 0) diff = 0;

    const d = Math.floor(diff / (1000 * 60 * 60 * 24));
    const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const m = Math.floor((diff / (1000 * 60)) % 60);
    const s = Math.floor((diff / 1000) % 60);

    document.getElementById("days").innerText = String(d).padStart(3, "0");
    document.getElementById("hours").innerText = String(h).padStart(2, "0");
    document.getElementById("minutes").innerText = String(m).padStart(2, "0");
    document.getElementById("seconds").innerText = String(s).padStart(2, "0");
}, 50);
</script>

</body>
</html>
