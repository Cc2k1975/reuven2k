<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>×¡×œ×™×—×” ××”?!</title>

<style>
    body{
        margin:0;
        font-family: 'Heebo', sans-serif;
        background: linear-gradient(135deg,#ff9a9e,#fad0c4);
        color:#222;
        text-align:center;
    }
    h1{
        margin-top:20px;
        font-size:32px;
        color:#fff;
        text-shadow:0 2px 4px rgba(0,0,0,0.3);
    }
    #startBtn{
        margin:20px auto;
        padding:18px 32px;
        font-size:24px;
        background:#00c853;
        color:white;
        border:none;
        border-radius:18px;
        box-shadow:0 4px 10px rgba(0,0,0,0.2);
        cursor:pointer;
    }
    #bigTimer{
        font-size:48px;
        margin-top:10px;
        color:white;
        font-weight:700;
    }
    #card{
        margin:25px auto;
        width:80%;
        max-width:400px;
        background:white;
        padding:40px 20px;
        font-size:36px;
        border-radius:22px;
        box-shadow:0 6px 14px rgba(0,0,0,0.25);
        display:none;
    }
    #smallTimer{
        margin-top:15px;
        font-size:28px;
        color:#fff;
        font-weight:600;
    }
    .btnRow{
        margin-top:20px;
        display:flex;
        justify-content:center;
        gap:22px;
    }
    .gameBtn{
        padding:18px 26px;
        font-size:22px;
        border:none;
        border-radius:16px;
        cursor:pointer;
        color:white;
        box-shadow:0 4px 10px rgba(0,0,0,0.2);
    }
    #yesBtn{ background:#00c853; }
    #noBtn{ background:#d50000; }

    #summaryBox{
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.6);
        display:none;
        align-items:center;
        justify-content:center;
    }
    #summaryInner{
        background:white;
        padding:30px;
        width:80%;
        max-width:380px;
        border-radius:18px;
        text-align:center;
        box-shadow:0 6px 20px rgba(0,0,0,0.4);
    }
    #summaryInner h2{
        margin-top:0;
        font-size:28px;
    }
    #againBtn{
        margin-top:20px;
        padding:16px 30px;
        font-size:22px;
        background:#2196f3;
        color:white;
        border:none;
        border-radius:16px;
        cursor:pointer;
    }

    /* ×—×œ×•×Ÿ ×”×’×“×¨×•×ª × ×¡×ª×¨ */
    #setupBox{
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.6);
        display:none;
        align-items:center;
        justify-content:center;
        z-index:9999;
    }
    #setupInner{
        background:white;
        padding:30px;
        width:80%;
        max-width:350px;
        border-radius:18px;
        text-align:center;
        box-shadow:0 6px 20px rgba(0,0,0,0.4);
    }
    #setupInner h2{
        margin-top:0;
        font-size:24px;
    }
    #setupInner label{
        display:block;
        margin-top:10px;
        font-size:18px;
    }
    #cardTimeInput{
        width:120px;
        padding:10px;
        font-size:20px;
        margin-top:10px;
        border-radius:10px;
        border:1px solid #ccc;
        text-align:center;
    }
    #saveSetupBtn{
        margin-top:20px;
        padding:12px 26px;
        font-size:20px;
        background:#2196f3;
        color:white;
        border:none;
        border-radius:12px;
        cursor:pointer;
    }
</style>
</head>

<body>

<h1>ğŸ¤¯ ×¡×œ×™×—×” ××”?! ğŸ¤ª</h1>

<button id="startBtn">ğŸ® ×”×ª×—×œ ××©×—×§</button>
<div id="bigTimer">02:00</div>

<div id="card">×›××Ÿ ×ª×•×¤×™×¢ ×”××™×œ×”</div>
<div id="smallTimer"></div>

<div class="btnRow">
    <button id="yesBtn" class="gameBtn">âœ”ï¸ ×”×¦×œ×™×—</button>
    <button id="noBtn" class="gameBtn">âŒ ×œ× ×”×¦×œ×™×—</button>
</div>

<!-- × ×’×Ÿ ×”××•×–×™×§×” -->
<audio id="gameAudio" src="https://files.catbox.moe/zbf446.mp3"></audio>

<!-- ×ª×™×‘×ª ×”×¡×™×›×•× -->
<div id="summaryBox">
    <div id="summaryInner">
        <h2>ğŸ‰ ×”×–××Ÿ × ×’××¨!</h2>
        <p id="sumSuccess"></p>
        <p id="sumFail"></p>
        <p id="sumTotal"></p>
        <button id="againBtn">ğŸ” ×©×—×§ ×©×•×‘</button>
    </div>
</div>

<!-- ×—×œ×•×Ÿ ×”×’×“×¨×•×ª × ×¡×ª×¨ -->
<div id="setupBox">
    <div id="setupInner">
        <h2>âš™ï¸ ×”×’×“×¨×•×ª ××©×—×§</h2>
        <label for="cardTimeInput">×–××Ÿ ×œ×›×œ ×§×œ×£ (×‘×©× ×™×•×ª):</label>
        <input id="cardTimeInput" type="number" min="5" max="60" value="20">
        <button id="saveSetupBtn">ğŸ’¾ ×©××•×¨</button>
    </div>
</div>

<script>
// ---------------------------------------------------
// ×¤×•× ×§×¦×™×™×ª ×“×™×‘×•×¨ â€” ××•×‘× ×” ×‘×˜×œ×¤×•×Ÿ
// ---------------------------------------------------
function speak(txt){
    const msg = new SpeechSynthesisUtterance(txt);
    msg.lang = "he-IL";
    msg.rate = 1;
    msg.pitch = 1;
    msg.volume = 0.85;  // ×˜×™×¤×” ×—×œ×© ×™×•×ª×¨ ××”×©×™×¨
    speechSynthesis.speak(msg);
}

// ---------------------------------------------------
// ×¨×©×™××ª ××™×œ×™×
// ---------------------------------------------------
const wordPairs = [
"×¡×‘× ×’×‘×•×”","×¡×‘× ×©××Ÿ","×¡×‘× ×¨×–×”","×¡×‘× ××¦×—×™×§","×¡×‘× ×—×–×§",
"×™×œ×“ ×©××—","×™×œ×“ ×›×•×¢×¡","×™×œ×“ ×§×˜×Ÿ","×™×œ×“ ×¨×¥","×™×œ×“ ×¦×•×—×§",
"×™×œ×“×” ×§×˜× ×”","×™×œ×“×” ×¨×¦×”","×™×œ×“×” ×—×›××”","×™×œ×“×” ×¦×•×—×§×ª","×™×œ×“×” ×—××•×“×”",
"×›×œ×‘ ×¨×˜×•×‘","×›×œ×‘ ×¨×¢×‘","×›×œ×‘ ×©××—","×›×œ×‘ ×¢×¦×œ×Ÿ","×›×œ×‘ ×’×“×•×œ",
"×—×ª×•×œ ×™×©×Ÿ","×—×ª×•×œ ×§×˜×Ÿ","×—×ª×•×œ ×§×•×¤×¥","×—×ª×•×œ ×©×—×•×¨","×—×ª×•×œ ×›×•×¢×¡",
"××•×˜×• ×›×ª×•×","××•×˜×• ×§×˜×Ÿ","××•×˜×• ××”×™×¨","××•×˜×• ×’×“×•×œ","××•×˜×• × ×§×™",
"×—×œ×•×Ÿ ×’×“×•×œ","×—×œ×•×Ÿ ×§×˜×Ÿ","×—×œ×•×Ÿ ×¤×ª×•×—","×—×œ×•×Ÿ ×¡×’×•×¨","×—×œ×•×Ÿ × ×§×™",
"×¡×•×¡ ×œ×‘×Ÿ","×¡×•×¡ ×—×•×","×¡×•×¡ ×—×–×§","×¡×•×¡ ××”×™×¨","×¡×•×¡ ×™×¤×”"
];

// ×¢×¨×‘×•×‘ ××§×¨××™
function shuffle(arr){
    for(let i = arr.length -1; i > 0; i--){
        let j = Math.floor(Math.random() * (i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}
shuffle(wordPairs);

let index = 0;
let success = 0;
let fail = 0;

let mainTimer = 120;

// ×–××Ÿ ×‘×¨×™×¨×ª ××—×“×œ ×œ×§×œ×£
const defaultCardTime = 20;
// × ×˜×¢×Ÿ ×–××Ÿ ××•×ª×× ×× ×§×™×™×
let storedTime = parseInt(localStorage.getItem("cardTime") || defaultCardTime);
if(isNaN(storedTime) || storedTime < 5 || storedTime > 60){
    storedTime = defaultCardTime;
}
let perCardTime = storedTime;
let cardTimer = perCardTime;

let mainInterval = null;
let cardInterval = null;

const startBtn = document.getElementById("startBtn");
const cardBox = document.getElementById("card");
const bigTimer = document.getElementById("bigTimer");
const smallTimer = document.getElementById("smallTimer");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const sumBox = document.getElementById("summaryBox");
const audio = document.getElementById("gameAudio");

const setupBox = document.getElementById("setupBox");
const cardTimeInput = document.getElementById("cardTimeInput");
const saveSetupBtn = document.getElementById("saveSetupBtn");
const titleEl = document.querySelector("h1");

// ---------------------------------------------------
// ×”×’×“×¨×•×ª â€” ×–××Ÿ ×§×œ×£ ××•×ª×× ××™×©×™×ª
// ---------------------------------------------------
cardTimeInput.value = perCardTime;

saveSetupBtn.onclick = ()=>{
    const newTime = parseInt(cardTimeInput.value);
    if(!isNaN(newTime) && newTime >= 5 && newTime <= 60){
        perCardTime = newTime;
        localStorage.setItem("cardTime", newTime);
        alert("×”×”×’×“×¨×” × ×©××¨×”! (×–××Ÿ ×œ×›×œ ×§×œ×£: " + newTime + " ×©× ×™×•×ª)");
        setupBox.style.display = "none";
    } else {
        alert("×¢×¨×š ×œ× ×—×•×§×™ â€” ×‘×—×¨ ×‘×™×Ÿ 5 ×œÖ¾60 ×©× ×™×•×ª.");
    }
};

function openSetup(){
    cardTimeInput.value = perCardTime;
    setupBox.style.display = "flex";
}

// ×œ×—×™×¦×” ××¨×•×›×” 5 ×©× ×™×•×ª ×¢×œ ×”×›×•×ª×¨×ª
let pressTimer = null;

function startPressTimer(e){
    e.preventDefault();
    if(pressTimer === null){
        pressTimer = setTimeout(()=>{
            openSetup();
        }, 5000); // 5 ×©× ×™×•×ª
    }
}

function cancelPressTimer(){
    if(pressTimer !== null){
        clearTimeout(pressTimer);
        pressTimer = null;
    }
}

titleEl.addEventListener("mousedown", startPressTimer);
titleEl.addEventListener("mouseup", cancelPressTimer);
titleEl.addEventListener("mouseleave", cancelPressTimer);
titleEl.addEventListener("touchstart", startPressTimer);
titleEl.addEventListener("touchend", cancelPressTimer);
titleEl.addEventListener("touchcancel", cancelPressTimer);

// ×œ×—×™×¦×” ×¢×œ ×”×¨×§×¢ ×©×œ ×”×”×’×“×¨×•×ª ×¡×•×’×¨×ª (×œ× ×—×•×‘×”, ××‘×œ × ×•×—)
setupBox.addEventListener("click", (e)=>{
    if(e.target === setupBox){
        setupBox.style.display = "none";
    }
});

// ---------------------------------------------------
// ×˜×¢×™× ×ª ×§×œ×£ ×—×“×©
// ---------------------------------------------------
function loadCard(){
    if(index >= wordPairs.length){
        index = 0;
        shuffle(wordPairs);
    }
    cardBox.innerText = wordPairs[index];
    index++;
    resetCardTimer();
}

function resetCardTimer(){
    cardTimer = perCardTime;
    smallTimer.innerText = "â±ï¸ " + cardTimer;
    clearInterval(cardInterval);
    cardInterval = setInterval(()=>{
        cardTimer--;
        smallTimer.innerText = "â±ï¸ " + cardTimer;

        if(cardTimer <= 0){
            clearInterval(cardInterval);
            fail++;
            loadCard();
        }
    },1000);
}

// ---------------------------------------------------
// ×”×ª×—×œ×ª ××©×—×§
// ---------------------------------------------------
startBtn.onclick = ()=>{
    startBtn.style.display = "none";
    cardBox.style.display = "block";

    // ×”×¤×¢×œ×ª ×©×™×¨
    audio.currentTime = 0;
    audio.play();

    // ×“×™×‘×•×¨ ××•×˜×•××˜×™ ×‘××”×œ×š ×”××©×—×§
    setTimeout(()=>speak("× ×©××¨×” ×“×§×” ×•×—×¦×™"), 30000);
    setTimeout(()=>speak("× ×©××¨×” ×“×§×”"), 60000);
    setTimeout(()=>speak("× ×©××¨×• ×©×œ×•×©×™× ×©× ×™×•×ª"), 90000);

    // ×¡×¤×™×¨×” 10â€“1
    setTimeout(()=>{
        let x = 10;
        let intv = setInterval(()=>{
            speak(x.toString());
            x--;
            if(x === 0){
                clearInterval(intv);
                speak("× ×’××¨ ×”×–××Ÿ");
            }
        }, 1000);
    }, 110000);

    loadCard();

    mainInterval = setInterval(()=>{
        mainTimer--;
        let m = Math.floor(mainTimer / 60);
        let s = mainTimer % 60;
        if(s < 10) s = "0"+s;
        bigTimer.innerText = m + ":" + s;

        if(mainTimer <= 0){
            endGame();
        }
    },1000);
};

// ---------------------------------------------------
yesBtn.onclick = ()=>{
    success++;
    loadCard();
};

noBtn.onclick = ()=>{
    fail++;
    loadCard();
};

// ---------------------------------------------------
function endGame(){
    clearInterval(mainInterval);
    clearInterval(cardInterval);
    audio.pause();

    document.getElementById("sumSuccess").innerText = "âœ”ï¸ ×”×¦×œ×—×•×ª: " + success;
    document.getElementById("sumFail").innerText = "âŒ ×œ× ×”×¦×œ×™×—: " + fail;
    document.getElementById("sumTotal").innerText = "ğŸƒ ×¡×”×´×› ×§×œ×¤×™×: " + (success + fail);

    sumBox.style.display = "flex";
}

document.getElementById("againBtn").onclick = ()=>{
    location.reload();
};
</script>

</body>
</html>
