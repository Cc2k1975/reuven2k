<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>רדיו חי</title>

<!-- אייקון למסך הבית / טאבים -->
<link rel="icon" type="image/png" sizes="192x192" href="https://reuven2k.com/radio.png">
<link rel="apple-touch-icon" href="https://reuven2k.com/radio.png">

<!-- קישור לקובץ המניפסט (PWA) -->
<link rel="manifest" href="radio-manifest.json">

<meta name="theme-color" content="#000000">

<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  html, body {
    width: 100%;
    height: 100%;
    background: #000;
    overflow: hidden;
    overscroll-behavior: none;
    display: flex;
    flex-direction: column;
    user-select: none;
  }

  .container {
    flex: 1;
    display: grid;
    grid-template-rows: 1fr auto 1fr; /* תחנה – שעון+אקוולייזר – תחנה */
  }

  .station {
    width: 100%;
    height: 100%;
    border: none;
    outline: none;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .station img {
    width: 70%;
    height: auto;
    max-height: 75%;
    aspect-ratio: 1 / 1;
    object-fit: contain;
    border-radius: 16px;
    box-shadow: 0 8px 20px rgba(255,255,255,0.15);
    background: #000;
    padding: 10px;
    transition: 0.15s;
  }

  .station:active img {
    transform: scale(0.93);
    filter: brightness(1.15);
  }

  .middle {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 4px 0;
  }

  /* שעון ניאון */
  #clock {
    font-family: "Courier New", monospace;
    font-size: clamp(3rem, 9vw, 4.2rem);
    color: #00e5ff;
    text-shadow:
      0 0 8px  #00e5ff,
      0 0 16px #00e5ff,
      0 0 30px #00bcd4,
      0 0 45px #0088aa;
    letter-spacing: 0.15em;
    animation: breathe 2.4s ease-in-out infinite;
  }

  @keyframes breathe {
    0%   { transform: scale(1);    opacity: 0.9; }
    50%  { transform: scale(1.05); opacity: 1;   }
    100% { transform: scale(1);    opacity: 0.9; }
  }

  /* אקולייזר */
  .eq {
    display: flex;
    gap: 4px;
    height: 18px;
    margin-top: 2px;
  }

  .eq-bar {
    width: 6px;
    border-radius: 20px;
    background: #00e5ff;
    box-shadow:
      0 0 6px  #00e5ff,
      0 0 12px #00bcd4;
    transform-origin: bottom;
    transform: scaleY(0.2);
    animation: eqPulse 1s infinite ease-in-out;
    animation-play-state: paused; /* ברירת מחדל – לא זז */
  }

  .eq-bar:nth-child(1) { animation-duration: 0.9s; }
  .eq-bar:nth-child(2) { animation-duration: 1.1s; }
  .eq-bar:nth-child(3) { animation-duration: 0.8s; }
  .eq-bar:nth-child(4) { animation-duration: 1.05s; }
  .eq-bar:nth-child(5) { animation-duration: 0.95s; }

  @keyframes eqPulse {
    0%   { transform: scaleY(0.2); }
    40%  { transform: scaleY(1);   }
    80%  { transform: scaleY(0.4); }
    100% { transform: scaleY(0.2); }
  }

  /* כשהנגן פעיל – מפעילים את האקולייזר */
  .eq.playing .eq-bar {
    animation-play-state: running;
  }

  #muteBtn {
    width: 100%;
    padding: 18px;
    background: #222;
    color: #fff;
    border: none;
    font-size: 1.3rem;
    font-weight: bold;
    cursor: pointer;
  }

  #muteBtn:active {
    background: #444;
  }

  audio { display: none; }
</style>

</head>
<body>

<div class="container">

  <!-- 99.5 -->
  <button class="station" onclick="playStream('995')">
    <img src="https://media.radiodeck.com/stations/5f74f75c664ee8400841f6b9/profile/605933e0f197d64e94f5f0a4/xl.jpg" alt="">
  </button>

  <!-- שעון + אקולייזר -->
  <div class="middle">
    <div id="clock">00:00</div>
    <div class="eq" id="eq">
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
      <div class="eq-bar"></div>
    </div>
  </div>

  <!-- 101.5 -->
  <button class="station" onclick="playStream('1015')">
    <img src="https://fm1.co.il/assets/stations/radio-darom-1015.png" alt="">
  </button>

</div>

<button id="muteBtn" onclick="toggleMute()">השתק ניגון</button>

<audio id="player"></audio>

<script>
  const streams = {
    "995":  "https://cdna.streamgates.net/Radios_Radio_App/Ham_Esh/playlist.m3u8",
    "1015": "https://radio.streamgates.net/stream/hatahana"
  };

  const player  = document.getElementById("player");
  const muteBtn = document.getElementById("muteBtn");
  const eqEl    = document.getElementById("eq");

  function vibrate() {
    if (navigator.vibrate) navigator.vibrate(50);
  }

  function updateEqState() {
    // playing אם יש מקור, לא על mute, ולא מושהה
    if (player.src && !player.muted && !player.paused) {
      eqEl.classList.add("playing");
    } else {
      eqEl.classList.remove("playing");
    }
  }

  function playStream(id) {
    vibrate();

    if (id === "995") {
      if (player.src !== streams[id]) player.src = streams[id];
      player.play().then(updateEqState).catch(() => {
        window.open("https://995.co.il/popup-player", "_blank");
      });
    } else {
      if (player.src !== streams[id]) player.src = streams[id];
      player.play().then(updateEqState).catch(err => {
        console.log("שגיאה בהפעלה של 101.5:", err);
      });
    }
  }

  function toggleMute() {
    vibrate();
    player.muted = !player.muted;
    muteBtn.textContent = player.muted ? "בטל השתק" : "השתק ניגון";
    updateEqState();
  }

  function updateClock() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2, "0");
    const m = String(now.getMinutes()).padStart(2, "0");
    const el = document.getElementById("clock");
    if (el) el.textContent = `${h}:${m}`;
  }

  updateClock();
  setInterval(updateClock, 1000 * 10);

  // אם הנגן משנה מצב (למשל מושהה באיזה מצב עתידי) – מעדכנים אקוולייזר
  player.addEventListener("play",  updateEqState);
  player.addEventListener("pause", updateEqState);
</script>

</body>
</html>
