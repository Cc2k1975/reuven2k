<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×©××™×œ×ª×ª ×¨×›×‘ - ×ª×•×¦××•×ª ××œ××•×ª</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #7195ba; display: flex; justify-content: center; padding: 20px; margin: 0; }
        .container { background: white; width: 100%; max-width: 480px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); overflow: hidden; }
        .search-area { padding: 15px; background: #f0f2f5; display: flex; gap: 8px; border-bottom: 1px solid #ddd; }
        input { flex: 1; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; outline: none; text-align: center; }
        button { padding: 12px 20px; background: #0088cc; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0077b5; }
        .results { padding: 20px; font-size: 15px; line-height: 1.7; white-space: pre-wrap; color: #000; display: none; }
        .status-msg { text-align: center; padding: 20px; color: #555; }
        b { color: #000; }
    </style>
</head>
<body>

<div class="container">
    <div class="search-area">
        <input type="text" id="carInput" placeholder="×”×›× ×¡ ××¡×¤×¨ ×¨×›×‘ (×œ××©×œ 20096003)" maxlength="8">
        <button onclick="getCarData()">×—×¤×©</button>
    </div>
    
    <div id="status" class="status-msg">×××ª×™×Ÿ ×œ×”×–× ×ª ××¡×¤×¨ ×¨×›×‘...</div>
    <div id="output" class="results"></div>
</div>

<script>
async function getCarData() {
    const carId = document.getElementById('carInput').value.trim();
    const output = document.getElementById('output');
    const status = document.getElementById('status');
    
    if (!carId) {
        status.innerHTML = "× × ×œ×”×–×™×Ÿ ××¡×¤×¨ ×¨×›×‘";
        return;
    }
    
    output.style.display = 'none';
    status.style.display = 'block';
    status.innerHTML = "××ª×—×‘×¨ ×œ×××’×¨ ×”×××©×œ×ª×™...";

    // ×©××™×œ×ª×” ×’××™×©×” (q) ×›×“×™ ×œ×”×‘×˜×™×— ××¦×™××ª × ×ª×•× ×™×
    const apiUrl = `https://data.gov.il/api/3/action/datastore_search?resource_id=053ad004-d6b0-461d-bc59-061749027582&q=${carId}`;
    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(apiUrl)}`;

    try {
        const response = await fetch(proxyUrl);
        const wrapper = await response.json();
        const data = JSON.parse(wrapper.contents);

        if (data.result && data.result.records && data.result.records.length > 0) {
            // ×¡×™× ×•×Ÿ ×”×ª×•×¦××” ×”××“×•×™×§×ª ×‘×™×•×ª×¨ ×œ××§×¨×” ×©×—×–×¨×• ×›××” ×¨×›×‘×™× ×“×•××™×
            const r = data.result.records.find(record => String(record.mispar_rechev) === carId) || data.result.records[0];
            
            let res = `ğŸ” ×ª×•×¦××•×ª ×—×™×¤×•×©:\n`;
            res += `----------------------------------\n`;
            res += `<b>××¡×¤×¨ ×¨×›×‘:</b> ${r.mispar_rechev}\n`;
            res += `<b>×§×•×“ ×ª×•×¦×¨:</b> ${r.samel_tozeret || '---'}\n`;
            res += `<b>×¡×•×’ ×“×’×(×¤×¨×˜×™ ××• ××¡×—×¨×™):</b> ${r.sug_deg_nm || '×¤×¨×˜×™'}\n`;
            res += `<b>×©× ×ª×•×¦×¨:</b> ${r.tozeret_nm}\n`;
            res += `<b>×§×•×“ ×“×’×:</b> ${r.samel_deg_nm || '---'}\n`;
            res += `<b>×©× ×“×’×:</b> ${r.kinuy_mishari}\n`;
            res += `<b>×¨××ª ×’×™××•×¨:</b> ${r.ramat_gimur || '(××™×Ÿ)'}\n`;
            res += `<b>×¨××ª ××‘×–×•×¨ ×‘×˜×™×—×•×ª×™:</b> ${r.ramat_eivzur_betichuti || '0'}\n`;
            res += `<b>×§×‘×•×¦×ª ×–×™×”×•×:</b> ${r.kvutzat_zihum || '---'}\n`;
            res += `<b>×©× ×ª ×™×¦×•×¨:</b> ${r.shnat_yitzur}\n`;
            res += `<b>×“×’× ×× ×•×¢:</b> ${r.deg_manua || '---'}\n`;
            res += `<b>×ª××¨×™×š ××‘×—×Ÿ(×˜×¡×˜):</b> ${r.mivchan_acharon_dt || '---'}\n`;
            res += `<b>×ª×•×§×£ ×¨×©×™×•×Ÿ ×¨×›×‘:</b> ${r.tokef_taz_rechev}\n`;
            res += `<b>×‘×¢×œ×•×ª:</b> ${r.baalut}\n`;
            res += `<b>××¡×¤×¨ ×©×œ×“×”:</b> ${r.mispar_shilda}\n`;
            res += `<b>×¦×‘×¢:</b> ${r.tzeva_rechev}\n`;
            res += `<b>×¦××™×’ ×§×“××™:</b> ${r.tzmig_kidmi || '---'}\n`;
            res += `<b>×¦××™×’ ××—×•×¨×™:</b> ${r.tzmig_achori || '---'}\n`;
            res += `<b>×¡×•×’ ×“×œ×§:</b> ${r.sug_delek_nm}\n`;
            res += `<b>××•×¢×“ ×¢×œ×™×” ×œ×›×‘×™×©:</b> ${r.moed_aliya_lakvish || '---'}\n`;
            res += `<b>×›×™× ×•×™ ××¡×—×¨×™:</b> ${r.kinuy_mishari}\n`;

            status.style.display = 'none';
            output.innerHTML = res;
            output.style.display = 'block';
        } else {
            status.innerHTML = "âŒ ×œ× × ××¦××• × ×ª×•× ×™× ×œ××¡×¤×¨ ×–×”.";
        }
    } catch (error) {
        status.innerHTML = "âš ï¸ ×©×’×™××” ×‘×ª×§×©×•×¨×ª. × ×¡×” ×©×•×‘.";
        console.error(error);
    }
}
</script>

</body>
</html>
