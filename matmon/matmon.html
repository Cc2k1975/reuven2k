<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注 转 砖 - 10 砖</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a1a; color: white; text-align: center; margin: 0; overflow: hidden; }
        #game-container { position: relative; display: inline-block; margin-top: 10px; border: 4px solid #444; background: #000; }
        #game-image { max-width: 85vw; max-height: 70vh; display: block; user-select: none; }
        
        /* 驻专  */
        #hidden-object {
            position: absolute;
            cursor: move;
            display: none;
            z-index: 10;
            line-height: 1;
        }

        /* 驻  */
        #admin-panel {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: #2c3e50; padding: 20px;
            border-radius: 15px; border: 3px solid #f1c40f;
            z-index: 1000; width: 300px; box-shadow: 0 0 100px rgba(0,0,0,0.8);
        }

        .btn { background: #f1c40f; color: black; border: none; padding: 8px 12px; margin: 4px; cursor: pointer; font-weight: bold; border-radius: 5px; }
        .btn:hover { background: #d4ac0d; }
        .save-btn { background: #2ecc71; color: white; width: 90%; margin-top: 15px; }
        .stage-selector { background: #34495e; color: white; padding: 5px; margin-bottom: 10px; width: 100%; }
        
        #ui-layer { margin: 10px; font-size: 20px; }
        .edit-mode-active { border: 4px dashed #f1c40f !important; }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div>砖: <span id="current-stage-display">1</span> | : <span id="timer">20</span></div>
        <div id="hint" style="color: #f1c40f; font-size: 16px;">(抓 5 砖转 爪 注专)</div>
    </div>

    <div id="game-container">
        <img id="game-image" src="1.png">
        <div id="hidden-object"><span id="object-emoji"></span></div>
    </div>

    <div id="admin-panel">
        <h2 style="margin-top:0">专转 砖</h2>
        
        <label>专 砖 注专:</label>
        <select id="stage-select" class="stage-selector" onchange="loadStageToEdit()">
            <option value="0">砖 1</option>
            <option value="1">砖 2</option>
            <option value="2">砖 3</option>
            <option value="3">砖 4</option>
            <option value="4">砖 5</option>
            <option value="5">砖 6</option>
            <option value="6">砖 7</option>
            <option value="7">砖 8</option>
            <option value="8">砖 9</option>
            <option value="9">砖 10</option>
        </select>

        <p>专 驻专:</p>
        <button class="btn" onclick="setEmoji('')"></button>
        <button class="btn" onclick="setEmoji('')"></button>
        <button class="btn" onclick="setEmoji('')"></button>
        <button class="btn" onclick="setEmoji('')"></button>

        <p> 驻专:</p>
        <button class="btn" onclick="changeSize(2)">+</button>
        <button class="btn" onclick="changeSize(-2)">-</button>

        <button class="btn save-btn" onclick="saveCurrentStage()">砖专 砖 </button>
        <button class="btn" style="background:#e74c3c; color:white;" onclick="closeAdmin()">住专</button>
    </div>

    <script>
        let gameData = JSON.parse(localStorage.getItem('myGameData')) || Array(10).fill(null).map(() => ({
            emoji: '', x: 50, y: 50, size: 20
        }));

        let currentStage = 0;
        let isEditMode = false;
        let pressTimer;

        const obj = document.getElementById('hidden-object');
        const img = document.getElementById('game-image');
        const admin = document.getElementById('admin-panel');
        const stageDisplay = document.getElementById('current-stage-display');

        // 爪 专 驻转转 注专
        window.onmousedown = (e) => {
            if (e.target.id === 'admin-panel' || admin.contains(e.target)) return;
            pressTimer = setTimeout(() => {
                isEditMode = true;
                admin.style.display = 'block';
                document.getElementById('game-container').classList.add('edit-mode-active');
                loadStageToEdit();
            }, 5000);
        };
        window.onmouseup = () => clearTimeout(pressTimer);

        function setEmoji(e) { document.getElementById('object-emoji').innerText = e; }
        
        function changeSize(amt) {
            let current = parseInt(window.getComputedStyle(obj).fontSize);
            obj.style.fontSize = (current + amt) + "px";
        }

        function loadStageToEdit() {
            let stageIdx = document.getElementById('stage-select').value;
            let data = gameData[stageIdx];
            obj.style.display = 'block';
            obj.style.left = data.x + '%';
            obj.style.top = data.y + '%';
            obj.style.fontSize = data.size + 'px';
            document.getElementById('object-emoji').innerText = data.emoji;
        }

        function saveCurrentStage() {
            let stageIdx = document.getElementById('stage-select').value;
            gameData[stageIdx] = {
                emoji: document.getElementById('object-emoji').innerText,
                x: parseFloat(obj.style.left),
                y: parseFloat(obj.style.top),
                size: parseInt(obj.style.fontSize)
            };
            localStorage.setItem('myGameData', JSON.stringify(gameData));
            alert("砖 " + (parseInt(stageIdx)+1) + " 砖专 爪!");
        }

        function closeAdmin() {
            admin.style.display = 'none';
            isEditMode = false;
            document.getElementById('game-container').classList.remove('edit-mode-active');
            playGame();
        }

        // 专专
        obj.onmousedown = function(e) {
            if(!isEditMode) {
                alert(" ! 爪转 转 拽!");
                if(currentStage < 9) {
                    currentStage++;
                    playGame();
                } else {
                    alert("住转 转  10 砖!");
                    currentStage = 0;
                    playGame();
                }
                return;
            }
            e.stopPropagation();
            let rect = img.getBoundingClientRect();
            function moveAt(pageX, pageY) {
                let x = ((pageX - rect.left) / rect.width) * 100;
                let y = ((pageY - rect.top) / rect.height) * 100;
                obj.style.left = Math.max(0, Math.min(98, x)) + '%';
                obj.style.top = Math.max(0, Math.min(98, y)) + '%';
            }
            function onMouseMove(e) { moveAt(e.pageX, e.pageY); }
            document.addEventListener('mousemove', onMouseMove);
            document.onmouseup = () => document.removeEventListener('mousemove', onMouseMove);
        };

        function playGame() {
            let data = gameData[currentStage];
            stageDisplay.innerText = currentStage + 1;
            obj.style.display = 'block';
            obj.style.left = data.x + '%';
            obj.style.top = data.y + '%';
            obj.style.fontSize = data.size + 'px';
            document.getElementById('object-emoji').innerText = data.emoji;
            //  驻砖专 住祝 拽 驻转 转 (1.png, 2.png ')
            // img.src = (currentStage + 1) + ".png"; 
        }

        window.onload = playGame;
    </script>
</body>
</html>
