<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waze Voice Commander</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            text-align: center;
        }

        #micBtn {
            width: 70vw;
            height: 70vw;
            max-width: 350px;
            max-height: 350px;
            border-radius: 50%;
            border: none;
            background-color: #33ccff; /* 爪注  专 */
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            -webkit-tap-highlight-color: transparent;
        }

        #micBtn:active {
            transform: scale(0.95);
        }

        #icon {
            font-size: 4rem;
            margin-bottom: 10px;
        }

        #statusText {
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            min-height: 30px;
        }

        #debugText {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
            background: #e0e0e0;
            padding: 5px 10px;
            border-radius: 5px;
            display: none; /* 住转专 注 砖专 */
        }

        /* 爪  拽 */
        .listening {
            background-color: #ff4444 !important; /*  */
            animation: pulse 1.5s infinite;
        }

        /* 注爪 砖砖 爪 */
        .success {
            background-color: #00C853 !important; /* 专拽 */
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(255, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0); }
        }
    </style>
</head>
<body>

    <button id="micBtn" onclick="startListening()">
        <div id="icon"></div>
        <div id="btnText">抓 专</div>
    </button>

    <div id="statusText">注专转 </div>
    <div id="debugText"></div>

    <script>
        // ==========================================
        //         专 注专转 拽转
        // ==========================================
        const locations = {
            "转": "https://waze.com/ul?q=Home", 
            "转": "https://waze.com/ul?q=Home", 
            "注": "https://waze.com/ul?q=Work",
            "注": "https://waze.com/ul?q=Work",
            "住驻专": "https://waze.com/ul?q=Supermarket",
            // 转住祝  注 砖专转 驻 爪专
        };
        // ==========================================

        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const micBtn = document.getElementById("micBtn");
        const btnText = document.getElementById("btnText");
        const statusText = document.getElementById("statusText");
        const debugText = document.getElementById("debugText");

        function startListening() {
            if (!SpeechRecognition) {
                alert("驻驻 砖  转. 住 Chrome 专.");
                return;
            }

            const recognition = new SpeechRecognition();
            recognition.lang = 'he-IL'; // 注专转
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.start();

            // 砖 专 驻转专 爪 拽
            micBtn.className = "listening";
            btnText.innerText = "拽砖...";
            statusText.innerText = "专 注砖...";
            debugText.style.display = "none";

            recognition.onresult = (event) => {
                // 拽转 拽住 拽专驻
                let speechResult = event.results[0][0].transcript;
                
                // 拽 专 转 住祝
                speechResult = speechResult.trim(); 

                // 爪 住  砖 砖注 (爪专 拽)
                debugText.style.display = "block";
                debugText.innerText = `注专转 砖注: "${speechResult}"`;

                // 拽   拽转 专砖
                //  拽   砖专转 ** 转 转  专砖
                let foundUrl = null;
                
                for (let key in locations) {
                    if (speechResult.includes(key)) {
                        foundUrl = locations[key];
                        break;
                    }
                }

                if (foundUrl) {
                    // --- 爪 转! ---
                    micBtn.className = "success"; // 驻 专拽
                    btnText.innerText = "!";
                    statusText.innerText = "驻转 转  注 2 砖转...";
                    
                    setTimeout(() => {
                        window.location.href = foundUrl;
                        // 专 转 驻转专 爪 专 专 驻转
                        setTimeout(() => {
                            micBtn.className = "";
                            btnText.innerText = "抓 专";
                            statusText.innerText = "注专转 ";
                        }, 1000);
                    }, 2000); // 砖 砖 2 砖转

                } else {
                    // ---  爪 转 ---
                    micBtn.className = ""; // 专 
                    btnText.innerText = " ";
                    statusText.innerText = "住 砖 (拽  砖 砖注 )";
                }
            };

            recognition.onspeechend = () => {
                recognition.stop();
                //   转 爪 (驻转专  专拽), 专 
                if (!micBtn.classList.contains("success")) {
                    micBtn.className = "";
                    btnText.innerText = "抓 专";
                }
            };

            recognition.onerror = (event) => {
                micBtn.className = "";
                btnText.innerText = "砖";
                
                if (event.error === 'not-allowed') {
                    statusText.innerText = "砖:  砖专 拽专驻!";
                    alert(" 砖专 砖砖 拽专驻  砖转专 -HTTPS");
                } else if (event.error === 'no-speech') {
                    statusText.innerText = " 砖注转 , 住 砖";
                } else {
                    statusText.innerText = "砖: " + event.error;
                }
            };
        }
    </script>
</body>
</html>
