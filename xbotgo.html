<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>שידור חי</title>
<style>
body {
  margin:0;
  overflow:hidden;
  background:#000;
  font-family:"Heebo",Arial,sans-serif;
}

/* כל הזירה (וידאו + שכבות) */
.player-shell {
  position:fixed;
  inset:0;
  background:#000;
  width:100vw;
  height:100vh;
  overflow:hidden;
}

/* הווידאו המסובב לרוחב */
.rotator {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%) rotate(-90deg) scale(1.7);
  transform-origin:center center;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  width:100vw;
  height:100vh;
}
.rotator iframe {
  border:none;
  width:100vw;
  height:100vh;
  background:#000;
}

/* הלוח: תוצאות + שעון */
.score-overlay-wrapper {
  position:absolute;
  top:12px;
  left:8px;
  z-index:10;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  font-family:Heebo,Arial,sans-serif;
  pointer-events:none; /* שלא יחסום לחיצות */
}
.overlay-body {
  display:flex;
  align-items:center;
  background:#1a1446;
  color:#fff;
  font-size:0.9rem;
  font-weight:600;
  border-radius:6px;
  box-shadow:0 4px 12px rgba(0,0,0,0.7);
}
.team-side {
  display:flex;
  align-items:center;
  white-space:nowrap;
}
.team-name {
  padding:4px 8px;
  color:#fff;
}
.team-score {
  background:#f4dd3a;
  color:#000;
  padding:4px 6px;
  font-weight:700;
  font-family:"Roboto Mono",monospace;
}
.timer-block {
  background:#fff;
  color:#000;
  font-weight:700;
  padding:4px 8px;
  font-family:"Roboto Mono",monospace;
}

/* כפתור מסך מלא – במרכז לפני הכניסה למסך מלא */
.fullscreen-btn {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  z-index:200;
  background:rgba(0,0,0,0.55);
  color:#00ffa9;
  border:1px solid rgba(0,255,169,0.6);
  border-radius:12px;
  padding:14px 26px;
  font-size:1.2rem;
  font-weight:600;
  cursor:pointer;
  box-shadow:0 8px 24px rgba(0,0,0,0.8);
  transition:background 0.3s,transform 0.3s;
}
.fullscreen-btn:active {
  transform:translate(-50%,-50%) scale(0.97);
}

/* האייקון הסודי שפותח את בקרת השידור */
.channel-logo {
  position:absolute;
  top:8px;
  right:8px;
  width:48px;
  height:48px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,0.4);
  box-shadow:0 0 10px rgba(0,0,0,0.7);
  cursor:pointer;
  z-index:150;
  object-fit:cover;
}

/* פופאפ הבקרה */
.edit-popup {
  position:absolute;
  top:60px;
  right:50%;
  transform:translateX(50%);
  background:#1a1f2b;
  color:#fff;
  border-radius:12px;
  box-shadow:0 30px 60px rgba(0,0,0,0.9);
  border:1px solid rgba(255,255,255,0.15);
  padding:20px;
  width:320px;
  max-width:90vw;
  font-size:0.9rem;
  line-height:1.5;
  display:none;
  z-index:300;
  text-align:right;
}
.edit-popup h2 {
  font-size:1rem;
  text-align:center;
  margin-top:0;
  margin-bottom:14px;
  color:#fff;
}
.edit-field {
  margin-bottom:14px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.edit-field label {
  font-size:0.8rem;
  color:#9aa3b2;
}
.team-line {
  display:flex;
  flex-direction:row;
  gap:8px;
  width:100%;
}
.team-line input {
  flex:1;
}
.score-input {
  flex:0 0 60px;
  max-width:60px;
  text-align:center;
}
.edit-input {
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.2);
  background:#0f1115;
  color:#fff;
  padding:10px 12px;
  font-size:0.9rem;
  outline:none;
  width:100%;
}

.ctl-btn {
  width:100%;
  padding:10px 12px;
  border:1px solid rgba(255,255,255,0.2);
  background:#0f1115;
  color:#fff;
  border-radius:8px;
  cursor:pointer;
  margin-bottom:8px;
  font-size:0.9rem;
  font-weight:600;
  text-align:center;
}
</style>
</head>
<body>

<!-- שים לב: עכשיו כל מה שחשוב (וידאו, תוצאה, אייקון, פופאפ) חי בתוך אותו container -->
<div class="player-shell" id="videoContainer">

  <!-- הווידאו עצמו (ביוטיוב לייב) -->
  <div class="rotator">
    <iframe id="livePlayer"
      src="https://www.youtube.com/embed/live_stream?channel=UCu2doG-TFmd4b2paosdg1xg&autoplay=1&mute=1&playsinline=1"
      allow="autoplay; encrypted-media; picture-in-picture"
      /* הוסר allowfullscreen כדי שהטלפון לא יחטוף לנו את כל המסך רק לוידאו */
    ></iframe>
  </div>

  <!-- לוח התוצאה + שעון על המסך -->
  <div class="score-overlay-wrapper">
    <div class="overlay-body">
      <div class="team-side">
        <div class="team-name" id="teamHome_name">הפועל חיפה</div>
        <div class="team-score" id="teamHome_score">0</div>
      </div>
      <div class="timer-block" id="liveTimer">00:00</div>
      <div class="team-side">
        <div class="team-score" id="teamAway_score">0</div>
        <div class="team-name" id="teamAway_name">מכבי חיפה</div>
      </div>
    </div>
  </div>

  <!-- כפתור מסך מלא (נעלם אחרי שנכנסים למסך מלא) -->
  <button class="fullscreen-btn" id="fullscreenBtn">⛶ מסך מלא</button>

  <!-- לוגו סודי לפתיחת בקרות -->
  <img class="channel-logo" id="channelLogo"
    src="https://yt3.ggpht.com/XEIE69D8DP1huYwLhSrHbEPhU9nfLjqSX7P8mZ8NLceUeDX68BoH1ORcxWy-NufREOy9xo1Dkw=s600-c-k-c0x00ffffff-no-rj-rp-mo"
    alt="ערוץ">

  <!-- חלון בקרה חי -->
  <div class="edit-popup" id="editPopup">
    <h2>שליטה בשידור</h2>

    <div class="edit-field">
      <label>שם הליגה</label>
      <input class="edit-input" id="league_input" value="שידורי חי הפועל חיפה נערים א' 2009">
    </div>

    <div class="edit-field">
      <label>קבוצה ביתית + תוצאה</label>
      <div class="team-line">
        <input id="teamHome_input" class="edit-input" value="הפועל חיפה">
        <input id="scoreHome_input" class="edit-input score-input" type="number" min="0" value="0">
      </div>
    </div>

    <div class="edit-field">
      <label>קבוצה אורחת + תוצאה</label>
      <div class="team-line">
        <input id="teamAway_input" class="edit-input" value="מכבי חיפה">
        <input id="scoreAway_input" class="edit-input score-input" type="number" min="0" value="0">
      </div>
    </div>

    <button class="ctl-btn" id="startBtn">הפעל שעון</button>
    <button class="ctl-btn" id="pauseBtn">הפסקת מחצית / המשך</button>
    <button class="ctl-btn" id="resetBtn">איפוס שעון</button>
    <button class="ctl-btn" id="closePopupBtn">יציאה</button>
  </div>

</div> <!-- /videoContainer -->

<script>
/* ============ FULLSCREEN ============ */
const videoContainer = document.getElementById('videoContainer');
const fsBtn = document.getElementById('fullscreenBtn');

fsBtn.addEventListener('click', () => {
  // חשוב: עכשיו נבקש מסך מלא על ה-container שכולל את כל השכבות
  if (!document.fullscreenElement) {
    videoContainer.requestFullscreen().catch(err => {
      alert('לא ניתן לעבור למסך מלא: ' + err.message);
    });
  } else {
    document.exitFullscreen();
  }
});

document.addEventListener('fullscreenchange', () => {
  if (document.fullscreenElement) {
    // במסך מלא – אל תסתיר את התוצאה ולא את האייקון
    fsBtn.style.display = "none";
  } else {
    // חזרה ממצב מסך מלא – תחזיר את הכפתור
    fsBtn.style.display = "block";
  }
});


/* ============ חלון הבקרה ============ */
const logoBtn   = document.getElementById('channelLogo');
const popup     = document.getElementById('editPopup');
const closeBtn  = document.getElementById('closePopupBtn');

logoBtn.addEventListener('click', () => {
  popup.style.display = (popup.style.display === "block") ? "none" : "block";
});

closeBtn.addEventListener('click', () => {
  popup.style.display = "none";
});


/* ============ שעון משחק ============ */
let startTime   = null; // מתי התחלנו את הריצה הנוכחית
let running     = false;
let pausedTotal = 0;    // סך הכול זמן שנצבר לפני עצירות (במילישניות)

function fmt(sec){
  const m = Math.floor(sec/60);
  const s = sec % 60;
  return String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

function tickClock(){
  const box = document.getElementById('liveTimer');
  if(!box) return;
  if(!running || startTime===null){
    const stoppedSec = Math.floor(pausedTotal/1000);
    box.textContent = fmt(stoppedSec);
    return;
  }
  const now = Date.now();
  const totalMs = pausedTotal + (now - startTime);
  const totalSec = Math.floor(totalMs/1000);
  box.textContent = fmt(totalSec);
}

// עדכון התצוגה חצי שניה
setInterval(tickClock, 500);

// התחל שעון מהתחלה
document.getElementById('startBtn').addEventListener('click', ()=>{
  pausedTotal = 0;
  startTime = Date.now();
  running = true;
});

// עצור / המשך (מחצית)
document.getElementById('pauseBtn').addEventListener('click', ()=>{
  if(running){
    pausedTotal += Date.now() - startTime;
    running = false;
    startTime = null;
  } else {
    startTime = Date.now();
    running = true;
  }
});

// איפוס לגמרי
document.getElementById('resetBtn').addEventListener('click', ()=>{
  running = false;
  startTime = null;
  pausedTotal = 0;
  tickClock();
});


/* ============ עדכון קבוצות ותוצאות בלייב ============ */
function bindLiveField(inputId, outputId, fallbackToZero=false){
  const inp = document.getElementById(inputId);
  const out = document.getElementById(outputId);
  if(!inp || !out) return;
  const apply = ()=>{
    let v = inp.value;
    if (fallbackToZero && v.trim()==="") v="0";
    out.textContent = v;
  };
  inp.addEventListener('input', apply);
  apply(); // סט ערך ראשוני
}

// שם קבוצה ביתית / תוצאה ביתית
bindLiveField("teamHome_input","teamHome_name",false);
bindLiveField("scoreHome_input","teamHome_score",true);

// שם קבוצה אורחת / תוצאה אורחת
bindLiveField("teamAway_input","teamAway_name",false);
bindLiveField("scoreAway_input","teamAway_score",true);

// שם הליגה כרגע לא מוצג על המסך בלייב (רק בחלון), אבל אפשר להוסיף overlay לטקסט הזה אם תרצה בהמשך.
</script>
</body>
</html>
