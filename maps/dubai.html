<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dubai Full Transport Network</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; }
        .search-bar { 
            position: fixed; top: 10px; left: 10px; right: 10px; z-index: 1000;
            display: flex; gap: 8px; background: white; padding: 10px; border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        input { flex: 1; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; outline: none; }
        button { padding: 10px 20px; background: #2c3e50; color: white; border: none; border-radius: 8px; font-weight: bold; }
        #map { flex: 1; width: 100%; }
    </style>
</head>
<body>

    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="חפש מקום או תחנה...">
        <button onclick="smartSearch()">חפש</button>
    </div>

    <div id="map"></div>

    <script>
        var map = L.map('map').setView([25.12, 55.20], 11);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // נתוני כל הקווים והצבעים מהמפה שלך
        const transportData = {
            red: { color: "#ff0000", name: "הקו האדום", stations: [
                {name: "Centrepoint", c: [25.2285, 55.4052]}, {name: "Airport T3", c: [25.2458, 55.3594]}, 
                {name: "Union", c: [25.2655, 55.3093]}, {name: "BurJuman", c: [25.2533, 55.3033]}, 
                {name: "Burj Khalifa", c: [25.1972, 55.2744]}, {name: "Expo 2020", c: [24.9633, 55.1511]}
            ]},
            green: { color: "#00b300", name: "הקו הירוק", stations: [
                {name: "Etisalat", c: [25.2639, 55.4050]}, {name: "Union", c: [25.2655, 55.3093]}, 
                {name: "Gold Souq", c: [25.2721, 55.2975]}, {name: "Creek", c: [25.2217, 55.3386]}
            ]},
            orange: { color: "#ff8c00", name: "Tram (כתום)", stations: [
                {name: "JBR 1", c: [25.0765, 55.1305]}, {name: "Marina Mall", c: [25.0768, 55.1354]}, 
                {name: "Palm Jumeirah Tram", c: [25.0945, 55.1466]}
            ]},
            blue: { color: "#0000ff", name: "הקו הכחול (עתידי)", stations: [
                {name: "Creek", c: [25.2217, 55.3386]}, {name: "Dubai Festival City", c: [25.2230, 55.3510]},
                {name: "International City", c: [25.1650, 55.4080]}
            ]},
            lightblue: { color: "#00bfff", name: "Monorail (תכלת)", stations: [
                {name: "Palm Gateway", c: [25.0934, 55.1504]}, {name: "Atlantis", c: [25.1332, 55.1171]}
            ]}
        };

        function drawAll() {
            for (let id in transportData) {
                const line = transportData[id];
                const coords = line.stations.map(s => s.c);

                // קו מחבר בצבע הקו
                L.polyline(coords, {color: line.color, weight: 3, opacity: 0.8}).addTo(map);

                // נקודות תחנה
                line.stations.forEach(s => {
                    L.circleMarker(s.c, {
                        radius: 6, fillColor: line.color, color: "#fff", weight: 2, fillOpacity: 1
                    }).addTo(map).bindPopup(`<b>${s.name}</b><br>${line.name}`);
                });
            }
        }

        drawAll();

        async function smartSearch() {
            let val = document.getElementById('searchInput').value;
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(val + " Dubai")}`);
            const data = await res.json();
            if (data.length > 0) {
                map.setView([data[0].lat, data[0].lon], 15);
                L.marker([data[0].lat, data[0].lon]).addTo(map).bindPopup(val).openPopup();
            }
        }
    </script>
</body>
</html>
