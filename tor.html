<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>×¡×•×¨×§ ×ª×•×¨×™× ××‘×•×“×™×</title>
    <style>
        body { font-family: system-ui, sans-serif; padding: 20px; background: #f0f0f0; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { color: #d63031; text-align: center; }
        .date-block { background: #eef2f3; margin-bottom: 15px; padding: 10px; border-radius: 8px; border-right: 5px solid #0984e3; }
        .date-title { font-weight: bold; font-size: 1.2rem; color: #2d3436; margin-bottom: 5px; }
        .appt-item { font-size: 1.1rem; padding: 5px 0; border-bottom: 1px solid #dfe6e9; }
        .empty-msg { text-align: center; font-size: 1.2rem; color: #636e72; margin-top: 30px; }
        .summary { background: #ffeaa7; padding: 10px; text-align: center; font-weight: bold; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ” ×¡×•×¨×§ ×–×™×›×¨×•×Ÿ - ×—×™×¤×•×© ×ª×•×¨×™×</h1>
    <div id="summary" class="summary">×˜×•×¢×Ÿ × ×ª×•× ×™×...</div>
    <div id="output"></div>
</div>

<script>
    const output = document.getElementById('output');
    const summary = document.getElementById('summary');
    
    // ××¤×ª×— ×”×–×™×›×¨×•×Ÿ ×©×‘×• ×”×©×ª××©× ×• ×›×œ ×”×–××Ÿ
    const KEY = 'salonAppointmentsByDate';
    
    try {
        const raw = localStorage.getItem(KEY);
        if (!raw) {
            summary.textContent = "âŒ ×”×–×™×›×¨×•×Ÿ ×¨×™×§ ×œ×’××¨×™ (×œ× × ××¦× ×”××¤×ª×— 'salonAppointmentsByDate').";
        } else {
            const data = JSON.parse(raw);
            const dates = Object.keys(data).sort();
            
            let totalAppts = 0;
            let foundContent = false;

            if (dates.length === 0) {
                summary.textContent = "ğŸ“‚ ×”×–×™×›×¨×•×Ÿ ×§×™×™×, ××š ××™×Ÿ ×‘×• ×ª××¨×™×›×™× ×©××•×¨×™×.";
            } else {
                dates.forEach(date => {
                    const appointments = data[date];
                    // ×‘×“×™×§×” ×× ×™×© ×ª×•×¨×™× ×××™×ª×™×™× ×‘×ª××¨×™×š ×”×–×”
                    const validTimes = Object.keys(appointments).filter(t => appointments[t].isMain);
                    
                    if (validTimes.length > 0) {
                        foundContent = true;
                        const div = document.createElement('div');
                        div.className = 'date-block';
                        
                        // ×”××¨×ª ×ª××¨×™×š ×œ××‘× ×” ×§×¨×™×
                        const [y, m, d] = date.split('-');
                        const niceDate = `${d}.${m}.${y}`;
                        
                        let html = `<div class="date-title">ğŸ“… ${niceDate} (${validTimes.length} ×ª×•×¨×™×)</div>`;
                        
                        validTimes.sort().forEach(time => {
                            const appt = appointments[time];
                            html += `<div class="appt-item">â° <strong>${time}</strong> - ${appt.name} <small>(${appt.minutes} ×“×§')</small></div>`;
                            totalAppts++;
                        });
                        
                        div.innerHTML = html;
                        output.appendChild(div);
                    }
                });

                if (foundContent) {
                    summary.textContent = `âœ… × ××¦××• ×¡×”×´×› ${totalAppts} ×ª×•×¨×™× ×‘×–×™×›×¨×•×Ÿ.`;
                } else {
                    summary.textContent = "âš ï¸ ×™×© ×ª××¨×™×›×™× ×‘×–×™×›×¨×•×Ÿ, ××š ×›×•×œ× ×¨×™×§×™× ××ª×•×¨×™×.";
                }
            }
        }
    } catch (e) {
        summary.textContent = "×©×’×™××” ×‘×§×¨×™××ª ×”× ×ª×•× ×™×: " + e.message;
    }
</script>

</body>
</html>
